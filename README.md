# CCSTX
Credit Card Sized Tickets Xtreme(?)

## Project structure
 - [`RSPS3018`](rsps3018) includes bindings to the CCSTX XML. Much of the source is autogenerated.

## Documentation

### Autogenerated CCSTX RSPS3018 types
RSP provide an XML document describing the structure and contents of every ticket
format we should support. There are requirements to be able to automate changes
from an updated XML document. For this reason, as well as reducing hand-written
boilerplate, we generate a lot of the abstract types from the XML in the
`io.otrl.ccstx.rsps3018` package. These types are generated at compile time, so
no other commands are required to build.

### Changing Field properties
There are some fields that need special emphasis depending on the value. Usually
the emphasis will default to `Regular` but changing it is straight forward. In
fact, as both `PartialField` and `PartialLiteral` are simply aliases for partially
applied constructors, you can change anything about them by fully applying them
inside another partial.
```scala
object Fields extends rsps3018.Fields {

  // Date of Start of Validity
  def field171(format: Format, validity: Validity): PartialField = { case (font, bounds) =>
    val date = formatDate(format)(validity.validFrom)
    if (format.id.value.startsWith("X")) field171(date)(font, bounds)
    else field171(date)(font.withEmphasis(Emphasis.Inverted), bounds)
  }
}
```
